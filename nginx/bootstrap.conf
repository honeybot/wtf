lua_package_path "/usr/local/wtf/vendor/lua/5.1/?.lua;/usr/local/wtf/vendor/share/lua/5.1/?.lua;/usr/local/wtf/vendor/share/lua/5.1/?/init.lua;/usr/local/wtf/?.lua;;";

lua_package_cpath "/usr/local/wtf/vendor/lib/lua/5.1/?.so;/usr/local/wtf/vendor/share/lib/lua/5.1/?.so;/usr/local/wtf/?.so;;";

init_by_lua_block {
  local ngx = ngx
  local loader = require("wtf.core.loader")
  loader:load_policies_from_dir("/usr/local/wtf/policy/")
  for _, policy in pairs(loader.policies) do
    policy:init()
  end
}

init_worker_by_lua_block {
  local loader = require("wtf.core.loader")
  for _, policy in pairs(loader.policies) do
    policy:init_worker()
  end
}